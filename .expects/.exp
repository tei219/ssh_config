#!/usr/bin/expect

set RemoteHost [lindex $argv 0]
set PW [lindex $argv 1]
set Prompt "\[#$%>\]"
#set ScriptRoot [pwd]

set PWlist [list [lindex $argv 1] [lindex $argv 2]]

#log_file ${ScriptRoot}/log/${RemoteHost}.log
log_file ${RemoteHost}.log

set timeout 5
set loop_counter 0

spawn env LANG=C /usr/bin/ssh ${RemoteHost}
while { ${loop_counter} <= 8} {
 set PW [lindex $PWlist $loop_counter]
 expect {
     -glob "(yes/no)?" {
         send "yes\n"
         exp_continue
     }
     -glob "password:" {
         send -- "${PW}\n"
         incr loop_counter 1
     }
     -glob "${Prompt}" {
         interact
         exit 0
     }
 }
}

